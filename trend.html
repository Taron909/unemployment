<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>è¶¨å‹¢åˆ†æï½œå°ç£å¤±æ¥­ç‡</title>

  <!-- Chart.js ä½¿ç”¨ defer é¿å…é˜»å¡ -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js" defer></script>

  <!-- W3.CSS + å­—é«” -->
  <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto+Sans+TC" />

  <style>
      :root {
        --brand-blue: #21409a;
        --brand-ink:  #133955;
        --brand-accent: #d65b29;
        --bg-cream: #fdfcd9;
        --footer-h: 68px; /* body padding-bottom ç”¨ */
      }
  
      *, *::before, *::after { box-sizing: border-box; }
      html,body{height:100%}
       body {
         font-family: 'Noto Sans TC', system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
         background-color: #fdfcd9;
         margin: 0;
         padding-bottom: 80px;   /* é ç•™ footer ç©ºé–“ */
         min-height:100vh;	                   
         
       }
  
      h2 { color: var(--brand-accent); margin-top:40px; }
  
      /* ===== é é¦– ===== */
      .header{
        background-color: var(--brand-blue);
        color:#fff;
        text-align:center;
        padding:24px 12px;
        font-size:clamp(1.4rem,2.5vw,2rem);
        font-weight:700;
      }
  
      /* å°è¦½åˆ— */
      nav {
        background-color: var(--brand-blue);
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
      }
      nav a {
        line-height: 2em;
        padding: 30px 50px;
        color: white;
        text-decoration: none;
        font-weight: bold;
        white-space: nowrap;
        font-size: clamp(0.9em, 2.5vw, 1.3em);
      }
      nav a:hover { background-color: #880e4f; }
      .w3-bar .active { background-color: #800080 !important; color: #fff !important; }
  
      /* ä¸»è¦å®¹å™¨ */
      main { max-width: 1200px; margin: 40px auto; padding: 0 20px; }
  
      .chart-section {
        display: flex; flex-wrap: wrap; gap: 30px; align-items: flex-start; margin-bottom: 20px; min-width: 0;
      }
      .chart-canvas {
        position: relative; flex: 1 1 600px; max-width: 700px; min-width: 300px; height: 420px; overflow: hidden;
      }
      .chart-canvas > canvas { position: absolute; inset: 0; }
      .chart-description { flex: 1 1 320px; min-width: 300px; max-width: 800px; line-height: 1.8; margin: auto; }
      .chart-description h3 { color: var(--brand-blue); font-size: 1.6em; margin-bottom: 10px; }
      .chart-description p, .chart-description li { font-size: 1.08em; }
  
      /* è¡¨æ ¼ï¼ˆæ¡Œæ©Ÿè¦–åœ–ï¼‰ */
      .table-container { overflow: auto; margin-top: 20px; max-height: 520px; }
      .table-container table {
        border-collapse: separate; border-spacing: 0; table-layout: fixed; width: 100%;
        background: #fffdf3; min-width: 320px;
      }
      .table-container th {
        background: var(--brand-blue); color: #fff; padding: 10px 12px;
        border: 1px solid #ccc; text-align: center; font-weight: 600; line-height: 1.5;
      }
      .table-container td {
        padding: 10px 12px; border: 1px solid #ccc; vertical-align: top; line-height: 1.4; text-align: center;
        white-space: normal; word-break: break-word; overflow-wrap: anywhere; hyphens: auto;
      }
      .table-container td b { color: #880e4f; }
      .table-container th:nth-child(1), .table-container td:nth-child(1) { width: 18%; } 
      .table-container th:nth-child(2), .table-container td:nth-child(2) { width: 18%; }
      .table-container th:nth-child(3), .table-container td:nth-child(3) { width: 64%; }
      .table-container { font-size: clamp(0.65rem, 1vw, 0.65rem); }
  
      /* é ç¢¼å°è¦½ */
      .nav-buttons { display: flex; justify-content: center; align-items: center; margin: 12px 0 0;; gap: 40px; flex-wrap: wrap; }
      .nav-buttons button {
        background: var(--brand-blue); color: #fff; border: none; padding: 10px 20px; font-size: 1em;
        cursor: pointer; border-radius: 5px; min-width: 80px;
      }
      .nav-buttons button:hover { background: #880e4f; }
      .page-indicator { font-weight: 700; color: var(--brand-blue); }
  
      .page { display: none; }
      .page.active { display: flex; }
  
      /* Footerï¼ˆçµ±ä¸€ç‰ˆæœ¬ï¼‰ */
      .footer {
        background: var(--brand-blue);
        color: #fff;
        text-align: center;
        padding: 16px;
        font-size: .95em;
        position: fixed; bottom: 0; left: 0; width: 100%;
        z-index: 10; line-height: 1.4;
      }
      .footer a { color: #fff; text-decoration: underline; }
  
      /* éŸ¿æ‡‰å¼ */
      @media (max-width: 992px) { nav.w3-bar a { padding: 14px 18px !important; } }
      @media (max-width: 768px){
        nav.w3-bar { flex-direction: column; }
        nav.w3-bar a { width: 100%; text-align: center; padding: 14px 18px; line-height: 1.6; }
        .chart-canvas { height: auto; aspect-ratio: 16/10; }
        .table-container table { min-width: 480px; }
      }
  
      /* æ‰‹æ©Ÿä¹Ÿç¶­æŒè¡¨æ ¼å¼ï¼ˆç”¨æ°´å¹³æ²å‹•ï¼Œä¸æ”¹æˆå¡ç‰‡ï¼‰ */
@media (max-width: 640px) {
  .table-container { 
    overflow-x: auto;            /* å…è¨±å·¦å³æ»‘å‹• */
    -webkit-overflow-scrolling: touch;
  }
  .table-container table { 
    width: auto; 
    min-width: 560px;            /* è®“å°è¢å¹•å‡ºç¾æ°´å¹³å·è»¸ */
    table-layout: fixed;
  }
  /* ç¶­æŒè¡¨æ ¼èªæ„ï¼Œä¸è½‰æˆ block/card */
  .table-container thead { display: table-header-group; }
  .table-container tbody { display: table-row-group; }
  .table-container tr    { display: table-row; }
  .table-container th,
  .table-container td    { display: table-cell; }
  .table-container td::before { content: none !important; }
}

  
      /* å¯è¦‹éµç›¤ç„¦é»ï¼ˆA11yï¼‰ */
      a:focus-visible, button:focus-visible {
        outline: 3px solid #ffcc33; outline-offset: 2px; border-radius: 4px;
      }
      /* æ¸›å°‘å‹•ç•«åå¥½ */
      @media (prefers-reduced-motion: reduce){
        *{animation:none!important;transition:none!important;scroll-behavior:auto!important}
      }
    </style>
</head>

<body>
  <header class="header">æ•¸æ“šä¹‹ä¸‹çš„ç¾å¯¦ï¼šé‡æ–°èªè­˜å°ç£å¤±æ¥­ç‡</header>

  <nav class="w3-bar w3-indigo">
    <a href="index.html"  class="w3-bar-item w3-button w3-hover-white">é¦–é </a>
    <a href="trend.html"  class="w3-bar-item w3-button w3-hover-white active" aria-current="page">è¶¨å‹¢åˆ†æ</a>
    <a href="policy.html" class="w3-bar-item w3-button w3-hover-white">åœ‹å®¶æ”¿ç­–</a>
    <a href="case.html"   class="w3-bar-item w3-button w3-hover-white">å¯¦éš›æ¡ˆä¾‹</a>
    <a href="chatbot.html" class="w3-bar-item w3-button w3-hover-white">æ™ºèƒ½è«®è©¢å®¤</a>
      </nav>

  <main>
    <!-- ç¬¬ä¸€é ï¼šæŠ˜ç·šåœ– + è‡ªå‹•è¡¨æ ¼ -->
    <section class="chart-section page active" id="page1">
      <div class="chart-canvas">
        <canvas id="lineChart"></canvas>
      </div>
      <div class="chart-description">
        <h3>å°ç£å¤±æ¥­ç¸½é‡çš„è®Šå‹•è¶¨å‹¢</h3>
        <p>å¤±æ¥­ç‡å°æ™¯æ°£å¾ªç’°ã€ç”¢æ¥­è½‰å‹èˆ‡å¤–éƒ¨è¡æ“Šï¼ˆå¦‚é‡‘èé¢¨æš´ã€ç–«æƒ…ï¼‰é«˜åº¦æ•æ„Ÿã€‚</p>
        <p><b>åŸºç¤å…¬å¼ï¼š</b> å¤±æ¥­ç‡ = å¤±æ¥­äººæ•¸ Ã· å‹å‹•åŠ› Ã— 100%</p>

        <div class="table-container">
          <table>
            <thead>
              <tr>
                <th>å¹´åº¦</th>
                <th>å¤±æ¥­ç‡ (%)</th>
                <th>é‡å¤§äº‹ä»¶æˆ–å½±éŸ¿å› ç´ </th>
              </tr>
            </thead>
            <tbody id="summary-rows"><!-- ç”± JS å‹•æ…‹å¡«å…¥ --></tbody>
          </table>
        </div>
      </div>
    </section>

    <!-- ç¬¬äºŒé ï¼šå †ç–Šé•·æ¢åœ– -->
    <section class="chart-section page" id="page2">
      <div class="chart-canvas">
        <canvas id="barChart"></canvas>
      </div>
      <div class="chart-description">
        <h3>å°ç£å‹å‹•å¸‚å ´ç¸½é«”çµæ§‹è®ŠåŒ–</h3>
        <p>å°±æ¥­èˆ‡å¤±æ¥­äººæ•¸çš„çµ„åˆåæ˜ å‹å‹•åŠ›è¦æ¨¡ï¼›äººå£çµæ§‹è®ŠåŒ–æœªå¿…ç­‰æ¯”ä¾‹è½‰åŒ–ç‚ºå°±æ¥­ã€‚</p>
        <ul>
          <li>ä¼æ¥­ç¼ºå·¥ï¼Ÿ</li>
          <li>å¸‚å ´ç¼ºå¥½å·¥ï¼Ÿ</li>
          <li>äººæ‰èˆ‡è·ç¼ºæ˜¯å¦ã€Œå°ä¸ä¸Šã€ï¼Ÿ</li>
        </ul>
      </div>
    </section>

    <!-- ç¬¬ä¸‰é ï¼šé›™æŠ˜ç·šåœ– -->
    <section class="chart-section page" id="page3">
      <div class="chart-canvas">
        <canvas id="dualLineChart"></canvas>
      </div>
      <div class="chart-description">
        <h3>åƒèˆ‡äº†ï¼Œå»æ²’è¢«é›‡ç”¨ï¼Ÿ</h3>
        <p>å°‡å‹å‹•åŠ›åƒèˆ‡ç‡èˆ‡ã€Œå°±æ¥­äººå£å  15 æ­²ä»¥ä¸Šäººå£ã€ä¸¦åˆ—ï¼Œè§€å¯ŸæŠ•å…¥èˆ‡è¢«é›‡ç”¨çš„è½å·®ã€‚</p>
        <ul>
          <li>é•·æœŸå¾…æ¥­ã€æ”¾æ£„æ±‚è·è€…</li>
          <li>å®¶å‹™è² æ“”ä¸‹æœªèƒ½åƒèˆ‡çš„å¥³æ€§</li>
          <li>éæ­£å¼ç¶“æ¿Ÿä¸­çš„æœªçµ±è¨ˆäººå£</li>
        </ul>
        <p>ğŸ“Œ å‹å‹•åŠ›åƒèˆ‡ç‡ =ï¼ˆåœ¨è·ï¼‹å¤±æ¥­ï¼‰Ã· 15 æ­²ä»¥ä¸Šäººå£ Ã— 100%</p>
      </div>
    </section>

    <div class="nav-buttons">
      <button onclick="changePage(-1)">ä¸Šä¸€é </button>
      <div class="page-indicator">ç¬¬ <span id="pageNum">1</span> / 3 é </div>
      <button onclick="changePage(1)">ä¸‹ä¸€é </button>
    </div>
  </main>

  <footer class="footer">
    ğŸ“© è¯çµ¡æˆ‘å€‘ Taron_Linï½œ<a href="#" onclick="openGmail()">blue8841269@gmail.com</a>
  </footer>

  <script>
    /* ===== åˆ‡é ç‹€æ…‹ ===== */
    const pages = document.querySelectorAll('.page');
    let currentPage = 0;
    let chartData = null;
    let lineChartInstance = null, barChartInstance = null, dualLineChartInstance = null;

    /* ===== å·¥å…·ï¼šè³‡æ–™æ­£è¦åŒ– ===== */
    function toNumberArray(arr) {
      return (arr || []).map(v => {
        if (typeof v === 'number') return v;
        if (v == null) return NaN;
        const n = parseFloat(String(v).replace(/[,%\s]/g, '').replace(/,/g, ''));
        return Number.isFinite(n) ? n : NaN;
      });
    }
    function toPercentString(value) {
      if (value == null) return '';
      if (typeof value !== 'number') value = parseFloat(String(value).replace(/[,%\s]/g, '').replace(/,/g, ''));
      if (!Number.isFinite(value)) return '';
      const isRatio = value > 0 && value <= 1;  // 0~1 è¦–ç‚ºæ¯”ä¾‹
      const pct = isRatio ? (value * 100) : value;
      return pct.toFixed(1);
    }

    /* ===== å¹´ä»½å¯¬é¬†åŒ¹é… ===== */
    function normalizeYearLabel(label) {
      if (label == null) return null;
      const s = String(label).trim();
      const minguo = s.match(/æ°‘åœ‹\s*([0-9]{1,3})\s*å¹´?/);
      if (minguo) { const y = parseInt(minguo[1],10); if (Number.isFinite(y)) return 1911 + y; }
      const western = s.match(/([12][0-9]{3})/);
      if (western) { const y = parseInt(western[1],10); if (Number.isFinite(y)) return y; }
      if (!isNaN(Number(s))) { const y = Number(s); if (Number.isInteger(y) && y >= 1900 && y <= 2100) return y; }
      return null;
    }
    function buildYearIndexMap(labels) {
      const map = new Map();
      (labels || []).forEach((lab, i) => { const y = normalizeYearLabel(lab); if (y != null && !map.has(y)) map.set(y, i); });
      return map;
    }
    function getRateByYear(year, yearIndexMap) {
      const idx = yearIndexMap.get(year);
      if (idx == null) return null;
      const arr = chartData?.line_chart_data?.datasets?.[0]?.data || [];
      const raw = arr[idx];
      if (raw == null) return null;
      const n = parseFloat(String(raw).replace(/[,%\s]/g, '').replace(/,/g, ''));
      return Number.isFinite(n) ? n : null;
    }

    /* ===== è¡¨æ ¼ï¼ˆå–®ä¸€å®šç¾©ï¼Œå« safeNoteï¼‰ ===== */
    function tableRowHTML(periodText, rateValue, note) {
      const rate = rateValue === '' ? '' : toPercentString(rateValue);
      const safeNote = (note == null || String(note).trim() === '') ? 'â€”' : note;
      return `<tr>
        <td data-label="å¹´åº¦"><b>${periodText}</b></td>
        <td data-label="å¤±æ¥­ç‡ (%)">${rate}</td>
        <td data-label="é‡å¤§äº‹ä»¶æˆ–å½±éŸ¿å› ç´ ">${safeNote}</td>
      </tr>`;
    }

    function renderSummaryTableFromJSON(yearIndexMap) {
      const tbody = document.getElementById('summary-rows');
      if (!tbody) return false;
      const table = chartData?.summary_table;
      if (!Array.isArray(table) || table.length === 0) return false;

      tbody.innerHTML = table.map(row => {
        const periodText = row.period ??
                           (row.year != null ? String(row.year) :
                           (row.start != null && row.end != null ? `${row.start}â€“${row.end}` : 'â€”'));
        let rateValue = row.rate;
        if (rateValue == null) {
          const y = row.year ?? row.start ?? null;
          const v = y != null ? getRateByYear(y, yearIndexMap) : null;
          rateValue = v ?? '';
        }
        return tableRowHTML(periodText, rateValue, row.note);
      }).join('');
      return true;
    }

    function renderSummaryTableAuto(yearIndexMap) {
      const tbody = document.getElementById('summary-rows');
      if (!tbody) return;

      const L = chartData?.line_chart_data?.labels || [];
      if (L.length === 0) { tbody.innerHTML = '<tr><td colspan="3">ï¼ˆæ²’æœ‰å¯ç”¨çš„å¹´ä»½è³‡æ–™ï¼‰</td></tr>'; return; }

      function rowForRangeFlexible(start, end, note) {
        const hasStart = yearIndexMap.has(start);
        const hasEnd   = yearIndexMap.has(end);
        if (!hasStart && !hasEnd) return '';
        const yearForRate = hasStart ? start : (hasEnd ? end : null);
        const v = yearForRate != null ? getRateByYear(yearForRate, yearIndexMap) : null;
        const periodText = (start != null && end != null) ? `${start}â€“${end}` :
                           (start ?? end ?? 'â€”');
        return tableRowHTML(periodText, v ?? '', note);
      }

      const lastLab = L[L.length - 1];
      const lastYear = normalizeYearLabel(lastLab);
      const lastVal = lastYear != null ? getRateByYear(lastYear, yearIndexMap) : null;

      const rows = [
        rowForRangeFlexible(1997, 1999, 'äºæ´²é‡‘èé¢¨æš´è¡æ“Šå¤–éŠ·èˆ‡è£½é€ æ¥­ï¼Œå¤±æ¥­ç‡ä¸Šå‡ã€‚'),
        rowForRangeFlexible(2001, 2002, 'ç¶²è·¯æ³¡æ²«ç ´è£‚ã€å…¨çƒæ™¯æ°£è¶¨ç·©ã€‚'),
        rowForRangeFlexible(2008, 2009, 'å…¨çƒé‡‘èæµ·å˜¯ï¼›æ”¿åºœæ¨æŒ¯èˆˆæ–¹æ¡ˆã€‚'),
        rowForRangeFlexible(2020, 2022, 'COVID-19 è¡æ“Šæ¥è§¸å‹æœå‹™æ¥­ï¼Œå¤±æ¥­ç‡æ³¢å‹•ã€‚'),
        (lastYear != null ? tableRowHTML(String(lastYear), lastVal ?? '', 'ç–«å¾Œå¾©ç”¦ï¼Œç¸½é«”å¤±æ¥­ç‡å›ç©©ï¼›éš±æ€§å¤±æ¥­èˆ‡å°±æ¥­å“è³ªä»å—é—œæ³¨ã€‚') : '')
      ].filter(Boolean);

      if (rows.length === 0) {
        const firstYear = normalizeYearLabel(L[0]);
        const firstVal  = firstYear != null ? getRateByYear(firstYear, yearIndexMap) : null;
        rows.push(
          tableRowHTML(String(firstYear ?? L[0]), firstVal ?? '', 'èµ·å§‹å¹´åº¦æ¨£æœ¬ã€‚'),
          tableRowHTML(String(lastYear  ?? lastLab), lastVal ?? '',  'æœ€æ–°å¹´åº¦æ¨£æœ¬ã€‚')
        );
      }

      tbody.innerHTML = rows.join('');
    }

    function buildSummaryTableWithMap() {
      const labels = chartData?.line_chart_data?.labels || [];
      const yearIndexMap = buildYearIndexMap(labels);
      const ok = renderSummaryTableFromJSON(yearIndexMap);
      if (!ok) renderSummaryTableAuto(yearIndexMap);
    }

    /* ===== Chart.jsï¼šåˆ‡é å®‰å…¨éŠ·æ¯€/é‡å»º ===== */
    function destroyChart(instance, canvasId) {
      if (instance) instance.destroy();
      const el = document.getElementById(canvasId);
      if (el) { el.width = el.height = undefined; }
    }

    function showPage(index) {
      if (index !== 0) { destroyChart(lineChartInstance, 'lineChart'); lineChartInstance = null; }
      if (index !== 1) { destroyChart(barChartInstance, 'barChart'); barChartInstance = null; }
      if (index !== 2) { destroyChart(dualLineChartInstance, 'dualLineChart'); dualLineChartInstance = null; }

      pages.forEach((p, i) => p.classList.toggle('active', i === index));
      document.getElementById('pageNum').textContent = index + 1;
      currentPage = index;

      if (!chartData) return;
      requestAnimationFrame(() => {
        switch (index) {
          case 0: initLineChart(); break;
          case 1: initBarChart(); break;
          case 2: initDualLineChart(); break;
        }
      });
    }
    function changePage(delta) {
      currentPage = (currentPage + delta + pages.length) % pages.length;
      showPage(currentPage);
    }

    /* æŠ˜ç·šåœ–ï¼šè‡ªå‹•åµæ¸¬ 0â€“1 æ¯”ä¾‹æˆ–ç™¾åˆ†æ¯” */
    function initLineChart() {
      if (lineChartInstance) return;
      const labels = chartData.line_chart_data.labels;
      const raw = chartData.line_chart_data.datasets[0].data;
      const series = toNumberArray(raw);

      const valid = series.filter(v => Number.isFinite(v));
      const ratioLike = valid.length ? (valid.filter(v => v <= 1).length / valid.length > 0.6) : false;
      const scaled = ratioLike ? series.map(v => v * 100) : series.slice(); // è½‰æˆç™¾åˆ†æ¯”åˆ»åº¦
      const yMax = Math.ceil((Math.max(...scaled.filter(Number.isFinite)) || 10) * 1.15);
      const yMin = Math.max(0, Math.floor((Math.min(...scaled.filter(Number.isFinite)) || 0) * 0.9));

      lineChartInstance = new Chart(document.getElementById('lineChart'), {
        type: 'line',
        data: { labels, datasets: [{
          label: 'å¤±æ¥­ç‡', data: scaled,
          borderColor: '#1a3f5f', backgroundColor: 'rgba(26,63,95,0.15)',
          borderWidth: 2, pointRadius: 0, fill: true, tension: 0.2
        }]},
        options: {
          responsive: true, maintainAspectRatio: false, layout: { padding: 10 },
          plugins: { legend: { display: false } },
          scales: {
            y: {
              min: yMin, max: yMax,
              title: { display: true, text: 'å¤±æ¥­ç‡ (%)', font: { size: 12 } },
              ticks: { callback: v => v + '%', font: { size: 10 } }
            },
            x: { title: { display: true, text: 'å¹´ä»½', font: { size: 12 } },
                 ticks: { autoSkip: false, maxRotation: 45, font: { size: 10 } } }
          }
        }
      });
      lineChartInstance.resize();
    }

    /* å †ç–Šé•·æ¢åœ–ï¼šè‡ªå‹•å°ºåº¦ */
    function initBarChart() {
      if (barChartInstance) return;
      const labels = chartData.bar_chart_data.labels;
      const emp = toNumberArray(chartData.bar_chart_data.datasets[0].data);
      const unemp = toNumberArray(chartData.bar_chart_data.datasets[1].data);

      const all = [...emp, ...unemp].filter(Number.isFinite);
      const min = Math.min(...all);
      const max = Math.max(...all);
      const pad = Math.max(50, Math.round((max - min) * 0.08)); // ç•™ 8% é‚Šç•Œ
      const yMin = Math.max(0, min - pad);
      const yMax = max + pad;

      barChartInstance = new Chart(document.getElementById('barChart'), {
        type: 'bar',
        data: { labels, datasets: [
          { label: 'å°±æ¥­äººæ•¸', data: emp,  backgroundColor: '#114b87', stack: 'stack1' },
          { label: 'å¤±æ¥­äººæ•¸', data: unemp, backgroundColor: '#f37021', stack: 'stack1' }
        ]},
        options: {
          responsive: true, maintainAspectRatio: false, layout: { padding: 10 },
          plugins: { legend: { position: 'top', labels: { font: { size: 12 } } } },
          scales: {
            x: { stacked: true, title: { display: true, text: 'å¹´ä»½', font: { size: 12 } },
                 ticks: { autoSkip: false, maxRotation: 45, font: { size: 10 } } },
            y: { stacked: true, min: yMin, max: yMax, title: { display: true, text: 'äººæ•¸ï¼ˆåƒäººï¼‰', font: { size: 12 } },
                 ticks: { font: { size: 10 } } }
          }
        }
      });
      barChartInstance.resize();
    }

    /* é›™æŠ˜ç·šåœ– */
    function initDualLineChart() {
      if (dualLineChartInstance) return;
      const labels = chartData.dual_line_chart_data.labels;
      const p1 = toNumberArray(chartData.dual_line_chart_data.datasets[0].data);
      const p2 = toNumberArray(chartData.dual_line_chart_data.datasets[1].data);

      dualLineChartInstance = new Chart(document.getElementById('dualLineChart'), {
        type: 'line',
        data: { labels, datasets: [
          { label: 'å‹å‹•åŠ›åƒèˆ‡ç‡(%)', data: p1, borderColor: '#114b87', backgroundColor: '#114b87', borderWidth: 4, fill: false, tension: 0.2, pointRadius: 0 },
          { label: 'å°±æ¥­äººå£å 15æ­²ä»¥ä¸Šæ°‘é–“äººå£(%)', data: p2, borderColor: '#f37021', backgroundColor: '#f37021', borderWidth: 4, fill: false, tension: 0.2, pointRadius: 0 }
        ]},
        options: {
          responsive: true, maintainAspectRatio: false, layout: { padding: 10 },
          plugins: { legend: { position: 'top', labels: { font: { size: 12 } } } },
          scales: {
            y: { suggestedMin: 53, suggestedMax: 62, title: { display: true, text: 'ç™¾åˆ†æ¯” (%)', font: { size: 12 } },
                 ticks: { callback: v => v + '%', font: { size: 10 } } },
            x: { title: { display: true, text: 'å¹´ä»½', font: { size: 12 } },
                 ticks: { autoSkip: false, maxRotation: 45, font: { size: 10 } } }
          }
        }
      });
      dualLineChartInstance.resize();
    }

    function openGmail() {
      const email = "blue8841269@gmail.com";
      const subject = encodeURIComponent("è©¢å•ï¼šå¤±æ¥­è¶¨å‹¢åˆ†æ");
      const body = encodeURIComponent("æ‚¨å¥½ï¼Œæˆ‘æƒ³äº†è§£å°ç£å¤±æ¥­ç‡è³‡æ–™çš„æ›´å¤šç´°ç¯€...");
      window.open(`https://mail.google.com/mail/?view=cm&fs=1&to=${email}&su=${subject}&body=${body}`, '_blank');
    }

    /* ===== å•Ÿå‹• ===== */
    fetch("chart_data_embed.json?v=" + Date.now())
      .then(res => res.json())
      .then(data => {
        chartData = data;
        showPage(currentPage);       // é¡¯ç¤ºç¬¬ 1 é ä¸¦å»ºåœ–
        buildSummaryTableWithMap();  // ç”Ÿæˆè¡¨æ ¼ï¼ˆJSON å„ªå…ˆï¼Œå¦å‰‡è‡ªå‹•ï¼‰

        window.addEventListener('resize', () => {
          lineChartInstance?.resize();
          barChartInstance?.resize();
          dualLineChartInstance?.resize();
        });
      })
      .catch(err => console.error("âŒ ç„¡æ³•è¼‰å…¥ chart_data_embed.json", err));

    // å°è¦½è‡ªå‹•é«˜äº®ç›®å‰é 
    document.querySelectorAll('nav a').forEach(a => {
      const href = a.getAttribute('href');
      const current = location.pathname.split('/').pop() || 'index.html';
      if (href === current) a.classList.add('active');
    });
  </script>
</body>
</html>
